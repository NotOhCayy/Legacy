<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SASP — Robbery Report</title>
<style>
:root{--bg:#0f172a;--panel:#0b1220;--border:#1e293b;--muted:#94a3b8;--text:#e2e8f0;--accent:#38bdf8}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
.wrap{max-width:1200px;margin:0 auto;padding:16px}
header{display:flex;align-items:center;gap:10px;margin-bottom:10px}
.logo{width:28px;height:28px;border-radius:8px;background:#0b1220 url('assets/sasp_badge.png') center/cover no-repeat;border:1px solid var(--border)}
h1{font-size:16px;margin:0}
small{color:var(--muted)}
.grid{display:grid;grid-template-columns:460px 1fr;gap:16px}
.card{background:var(--panel);border:1px solid var(--border);border-radius:12px;overflow:hidden}
.card h2{margin:0;padding:10px 12px;border-bottom:1px solid var(--border);font-size:13px;color:#cbd5e1}
.card .body{padding:12px}
.row{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px}
.full{grid-column:1/-1}
select,input[type=text]{width:100%;padding:8px 10px;border:1px solid var(--border);background:#0d1422;color:var(--text);border-radius:10px}
select{appearance:none;background-image:linear-gradient(45deg,transparent 50%,#64748b 50%),linear-gradient(135deg,#64748b 50%,transparent 50%),linear-gradient(to right,#0d1422,#0d1422);background-position:calc(100% - 18px) calc(1em + 2px),calc(100% - 13px) calc(1em + 2px),100% 0;background-size:5px 5px,5px 5px,2.5em 2.5em;background-repeat:no-repeat}
textarea{width:100%;height:380px;padding:10px;border:1px solid var(--border);background:#0d1422;color:var(--text);border-radius:10px;white-space:pre}
.group{margin:10px 0}
.group legend{color:#cbd5e1;font-weight:600;margin-bottom:6px}
/* checkbox alignment */
.checklist{display:grid;grid-template-columns:1fr max-content;row-gap:8px;column-gap:12px;align-items:center}
.check{display:flex;align-items:center;gap:8px}
.check input{width:16px;height:16px;margin:0}
.inline-nums{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
.btns{display:flex;gap:8px;justify-content:flex-end;margin-top:10px}
.btn{background:var(--accent);color:#081826;border:1px solid #1c97ba;padding:8px 12px;border-radius:10px;cursor:pointer}
.muted{color:var(--muted);font-size:12px}
.badge{display:inline-block;border:1px solid var(--border);background:#0d1422;padding:2px 6px;border-radius:6px;font-size:11px;margin-left:6px}
</style>
</head>
<body>
<div class="wrap">
<header>
  <div class="logo" aria-hidden="true"></div>
  <div>
    <h1>SASP — Robbery Report</h1>
  </div>
</header>

<div class="grid">
  <section class="card">
    <h2>Inputs</h2>
    <div class="body" id="inputs">
      <div class="row">
        <label class="full">Your Callsign &amp; Name
          <select id="you"></select>
        </label>
      </div>

      <div class="row">
        <label>Scene Command
          <select id="scene"></select>
        </label>
        <label>Negotiator
          <select id="nego"></select>
        </label>
      </div>

      <div class="row">
        <label class="full">Stayed Back For Hostage
          <select id="hostageBack"></select>
        </label>
      </div>

      <h3 class="muted">Pursuit Order</h3>
      <div class="row">
        <label>Primary
          <select id="p1"></select>
        </label>
        <label>Passenger
          <select id="p1pass"></select>
        </label>
      </div>
      <div class="row">
        <label>Secondary
          <select id="p2"></select>
        </label>
        <label>Passenger
          <select id="p2pass"></select>
        </label>
      </div>
      <div class="row">
        <label>Tertiary
          <select id="p3"></select>
        </label>
        <label>Passenger
          <select id="p3pass"></select>
        </label>
      </div>
      <div class="row">
        <label>Parallel
          <select id="par"></select>
        </label>
        <label>Passenger
          <select id="parpass"></select>
        </label>
      </div>

      <h3 class="muted">Robbery</h3>
      <div class="row">
        <label class="full">Type
          <select id="rType">
            <option value="Jewelry Store">Jewelry Store</option>
            <option value="Fleeca Bank">Fleeca Bank</option>
            <option value="24/7 Store">24/7 Store</option>
          </select>
        </label>
        <label class="full">Location
          <select id="rLoc"></select>
        </label>
      </div>

      <div class="inline-nums">
        <label>Inside
          <select id="inside"></select>
        </label>
        <label>Outside
          <select id="outside"></select>
        </label>
        <label>Hostages
          <select id="hostages"></select>
        </label>
      </div>

      <fieldset class="group">
        <legend>Demands</legend>
        <div class="checklist">
          <label class="check"><input type="checkbox" class="dm" value="free passage with no spikes on perimeter"> <span>free passage with no spikes on perimeter</span></label><span></span>
          <label class="check"><input type="checkbox" class="dm" value="free passage with no spikes on the whole chase"> <span>free passage with no spikes on the whole chase</span></label><span></span>
          <label class="check"><input type="checkbox" class="dm" value="no helicopter"> <span>no helicopter</span></label><span></span>
          <label class="check"><input type="checkbox" class="dm" value="no speed unit"> <span>no speed unit</span></label><span></span>
          <label class="check"><input type="checkbox" class="dm" value="no bike unit"> <span>no bike unit</span></label><span></span>
          <label class="check full"><input type="text" id="dmOther" placeholder="Other (optional)"/></label>
        </div>
      </fieldset>

      <h3 class="muted">Vehicle</h3>
      <div class="row">
        <label class="full">Description
          <input id="vehDesc" placeholder="e.g., Black Sultan RS">
        </label>
      </div>
      <div class="row">
        <label>Color
          <input id="vehColor" placeholder="Color">
        </label>
        <label>Plate
          <input id="vehPlate" placeholder="Plate">
        </label>
      </div>

      <h3 class="muted">Outcome</h3>
      <div class="row">
        <label class="full">How did the chase end?
          <select id="ending"></select>
        </label>
      </div>

      <h3 class="muted">Medical & Processing</h3>
      <div class="row">
        <label>Hospital
          <select id="hospital">
            <option>Saint Fiacre</option><option>Mount Zonah</option><option>Sandy Shores Medical</option><option>Paleto Hospital</option><option>Cayo Perico</option>
          </select>
        </label>
        <label>Processed at
          <select id="processedAt">
            <option>MRPD</option><option>Sandy Shores Sheriff's Office</option><option>Davis PD</option><option>Paleto Police Department</option><option>Highway Police Department</option>
          </select>
        </label>
      </div>
    </div>
  </section>

  <section class="card">
    <h2>Report</h2>
    <div class="body">
      <textarea id="out"></textarea>
      <div class="btns"><button class="btn" id="copy">Copy</button></div>
    </div>
  </section>
</div>
</div>

<script>
// ---------- data helpers ----------
const OFFICERS_URL='assets/officers.json';
const officersFallback=[]; // leave empty; page still works if JSON missing
const ENDINGS=[
 'Units lost eyes | Escaped','Suspects caught | General Ending','Surrendered | General Ending',
 'Got out of vehicle | Ran on foot | Caught','Got out of vehicle | Ran on foot | Escaped',
 'Vehicle disabled | Ran on foot | Caught','Vehicle disabled | Ran on foot | Escaped',
 'Vehicle disabled | Vehicle swap | Caught','Vehicle disabled | Vehicle swap | Escaped',
 'Vehicle boxed in | Surrendered','Vehicle tires popped | Ran on foot | Caught','Vehicle tires popped | Surrendered'
];
const FLEECA=['Legion Square','Burton','Rockford Hills (Lifeinvader)','Alta','Great Ocean','Route 68','Pink Cage'];
const TWOFOR7=['Strawberry 24/7','Davis LTD 24/7','Murrieta Heights Rob\\'s Liquor','Little Seoul LTD 24/7','Vespucci Canals Rob\\'s Liquor','Morningwood Rob\\'s Liquor','Mirror Park LTD 24/7','Downtown Vinewood 24/7','Tataviam Mountains 24/7','Banham Canyon Rob\\'s Liquor','Banham Canyon 24/7','Richman Glen LTD 24/7','Chumash 24/7','Harmony 24/7','Grand Senora 24/7','Grapeseed LTD 24/7','Mount Chilliad 24/7'];

// ---------- dom ----------
const ids=(...a)=>a.map(id=>document.getElementById(id));
const [you,scene,nego,hostageBack,p1,p1pass,p2,p2pass,p3,p3pass,par,parpass,rType,rLoc,inside,outside,hostages,vehDesc,vehColor,vehPlate,ending,hospital,processedAt,out,copyBtn]=
ids('you','scene','nego','hostageBack','p1','p1pass','p2','p2pass','p3','p3pass','par','parpass','rType','rLoc','inside','outside','hostages','vehDesc','vehColor','vehPlate','ending','hospital','processedAt','out','copy');

// ---------- populate helpers ----------
function optize(select, list, placeholder='— Select officer —'){
  select.innerHTML='';
  if(placeholder) select.appendChild(new Option(placeholder,''));
  (list||[]).forEach(o=> select.appendChild(new Option(`${o.cs} — ${o.name}`, `${o.cs} — ${o.name}`)));
}
function rangeSel(sel,max){ sel.innerHTML=''; for(let i=0;i<=max;i++) sel.appendChild(new Option(i,i)); }
function fillLocations(){
  const type=rType.value;
  rLoc.innerHTML='';
  if(type==='Fleeca Bank'){ FLEECA.forEach(x=>rLoc.appendChild(new Option(x,x))); }
  else if(type==='24/7 Store'){ TWOFOR7.forEach(x=>rLoc.appendChild(new Option(x,x))); }
  else { rLoc.appendChild(new Option('Vangelico Jewelry','Vangelico Jewelry')); }
}

// ---------- report builder ----------
function build(){
  const dm=[...document.querySelectorAll('.dm:checked')].map(x=>x.value);
  const other=document.getElementById('dmOther').value.trim(); if(other) dm.push(other);

  const sec = (title, lines)=>`[${title}]:\\n${lines.join('\\n')}`;
  const S = []; // sections

  // Reporting
  if(you.value) S.push(sec('REPORTING OFFICER',[you.value]));

  // Scene assignment
  const a1=scene.value||'[Insert Officer]';
  const a2=nego.value||'[Insert Officer]';
  const a3=hostageBack.value||'[Insert Officer]';
  S.push(sec('SCENE ASSIGNMENT',[`Scene Command: ${a1}`,`Negotiator: ${a2}`,`Stayed Back For Hostage: ${a3}`]));

  // Pursuit
  const purs=[['Primary',p1.value,p1pass.value],['Secondary',p2.value,p2pass.value],['Tertiary',p3.value,p3pass.value],['Parallel',par.value,parpass.value]]
    .filter(([_,u,p])=>u||p).map(([l,u,p])=>`${l}: ${u||'—'}${p?`  |  Passenger: ${p}`:''}`);
  if(purs.length) S.push(sec('INVOLVED IN PURSUIT', purs));

  // Details | Demands
  const numbers=[`Robbers Inside: ${inside.value}`,`Robbers Outside: ${outside.value}`,`Hostages: ${hostages.value}`];
  let demandLine = dm.length ? `Demands included: ${dm.join('; ')}.` : 'No special demands recorded.';
  const details = [
    `Robbery Type: ${rType.value}`,
    `Location: ${rLoc.value || '[Enter name]'}`,
    ...numbers,
    demandLine
  ];
  S.push(sec('DETAILS | DEMANDS', details));

  // Vehicle | Chase
  const v=[];
  if(vehDesc.value) v.push(`Vehicle: ${vehDesc.value}`);
  if(vehColor.value||vehPlate.value){
    v.push(`Details: ${vehColor.value?vehColor.value+' ':''}${vehPlate.value?('| Plate: '+vehPlate.value):''}`.trim());
  }
  v.push(`Ending: ${ending.value || '[Describe ending]'}`);
  S.push(sec('VEHICLE | CHASE', v));

  // Medical | Processing
  S.push(sec('MEDICAL | PROCESSING',[`Hospital: ${hospital.value}`,`Processed at: ${processedAt.value}`]));

  out.value = S.join('\\n\\n');
}

// ---------- wire ----------
;[you,scene,nego,hostageBack,p1,p1pass,p2,p2pass,p3,p3pass,par,parpass,rType,rLoc,inside,outside,hostages,vehDesc,vehColor,vehPlate,ending,hospital,processedAt]
.forEach(el=>el.addEventListener('change',build));
document.querySelectorAll('.dm').forEach(el=>el.addEventListener('change',build));
document.getElementById('dmOther').addEventListener('input',build);
copyBtn.addEventListener('click',()=>navigator.clipboard.writeText(out.value));

// ---------- init ----------
rangeSel(inside,6); rangeSel(outside,6); rangeSel(hostages,10);
ending.innerHTML = ENDINGS.map(x=>`<option>${x}</option>`).join('');
rType.addEventListener('change',()=>{ fillLocations(); build(); });

// load officers
fetch(OFFICERS_URL).then(r=> r.ok ? r.json(): Promise.resolve(officersFallback)).catch(()=>officersFallback).then(list=>{
  const L = Array.isArray(list)?list:officersFallback;
  [you,scene,nego,hostageBack,p1,p1pass,p2,p2pass,p3,p3pass,par,parpass].forEach(sel=>optize(sel,L));
  fillLocations();
  build();
});
</script>
</body>
</html>
